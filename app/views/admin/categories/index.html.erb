<div class="page-header">
  <h1>Categories</h1>
</div>

<div class="row">
  <%= render "form" %>
</div>

<div class="row table-responsive category-list ">
  <table class="table table-hover">
    <tr>
      <th></th>
      <th>Name</th>
      <th>Created at</th>
      <th>Last updated</th>
      <th>Products<br>Amount</th>
      <th>Status</th>
      <th>View</th>
      <th></th>
    </tr>
   
    <% sum = @categories.length 
       i = 1
    %> 

    <% @categories.order("updated_at DESC").each do |p| %>
      <% if i < sum %>
        <tr>
          <td><%= i %>. </td>
          <td id ="cat-name-<%= i %>"><%= p.name %></td>
          <td><%= p.created_at.to_formatted_s(:long) %></td>
          <td><%= p.updated_at.to_formatted_s(:long) %></td>
          <td>
            <%= link_to p.products.size, admin_category_products_path(p) %>
          </td>
          <td>

          <button type="button" class="btn <%= p.visible? ? "btn-success" : "btn-default" %> btn-xs" id="cat-status" data-edit=<%= admin_category_path(p) %> data-visible=<%= p.visible? %>><%= p.visible? ? "visible" : "hidden" %></button>
          </td>
          <td>
            <%= link_to category_path(p) do %>
              <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
            <% end %>
          </td>
          <td>
            <%= link_to edit_admin_category_path(p) do %>
              <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
            <% end %>
            <%= link_to admin_category_path(p), method: :delete, data: { confirm: "Are you sure?" } do %>
              <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
            <% end %>
          </td>
          <% i += 1%>
        </tr>
      <% end %>
    <% end %>
  </table>
</div>