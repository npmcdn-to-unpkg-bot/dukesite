<div class="row">
  <p class="pull-right">
    <%= link_to new_admin_product_path do %>
      <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> Add a product
    <% end %>
  </p>
</div>

<div class="row table-responsive">
  <table class="table table-hover">
    <tr>
      <th></th>
      <th class="col-sm-3">Title</th>
      <th class="col-sm-3">Description</th>
      <th class="col-sm-1">Categories</th>
      <th class="col-sm-1">Showcases</th>
      <th class="col-sm-1">Published</th>
      <th class="col-sm-2">Created at/<br>Last updated at</th>
      <th class="col-sm-1"></th>
    </tr>
    
    <% sum = products.length 
       i = 0
    %> 

    <% products.each do |p| %>
      <% if i < sum %>
        <tr>
          <td><%= i+1 %>. </td>
          <td><%= p.title %></td>
          <td><%= truncate(p.description) %></td>
          <td>
            <% p.categories.each do |pc| %>
              <%= pc.name %><br>
            <% end %>
          </td>
          <td>
            <% p.showcases.each do |s| %>
              <%= s.title %><br>
            <% end %>  
          </td>
          <td>
            <% if p.published %>
              Yes
            <% else %>
              No
            <% end %>
          </td>
          <td><%= p.created_at.to_formatted_s(:db) %><br>
              <%= p.updated_at.to_formatted_s(:db) %></td>
          <td>
            <%= link_to admin_product_path(p), target: "_blank" do %>
            <span class="glyphicon glyphicon-eye-open" aria-hidden="true"></span>
            <% end %>

            <%= link_to edit_admin_product_path(p) do %>
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
            <% end %>

            <%= link_to admin_product_path(p), method: :delete, data: { confirm: "Are you sure?" } do %>
            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
            <% end %>
          </td>
          <% i += 1%>
        </tr>
      <% end %>
    <% end %>
  </table>
</div>